<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Sol2ink/tutorial/building" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Building the ink! smart contract | Brushfam</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://learn.brushfam.io/docs/Sol2ink/tutorial/building"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Building the ink! smart contract | Brushfam"><meta data-rh="true" name="description" content="To build the ink! smart contract we will need cargo-contract. Note that the generated contracts use ink! version 3.4.0, so we will need to have cargo-contract version 1.5.1 installed. So if we satisfy this condition, we will navigate to the generated folder generated/contracts/erc_20 and call cargo contract build. The contract will start building; we will wait for a while and..."><meta data-rh="true" property="og:description" content="To build the ink! smart contract we will need cargo-contract. Note that the generated contracts use ink! version 3.4.0, so we will need to have cargo-contract version 1.5.1 installed. So if we satisfy this condition, we will navigate to the generated folder generated/contracts/erc_20 and call cargo contract build. The contract will start building; we will wait for a while and..."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://learn.brushfam.io/docs/Sol2ink/tutorial/building"><link data-rh="true" rel="alternate" href="https://learn.brushfam.io/docs/Sol2ink/tutorial/building" hreflang="en"><link data-rh="true" rel="alternate" href="https://learn.brushfam.io/docs/Sol2ink/tutorial/building" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ff7b4652.css">
<link rel="preload" href="/assets/js/runtime~main.5d853318.js" as="script">
<link rel="preload" href="/assets/js/main.2754e16f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://brushfam.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.svg" alt="Brushfam" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-dark.svg" alt="Brushfam" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/Brushfam_io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link">Twitter</a><a href="https://discord.gg/9FRETSPmp9" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link">Discord</a><a href="https://matrix.to/#/!utTuYglskDvqRRMQta:matrix.org?via=matrix.org&amp;via=t2bot.io&amp;via=web3.foundation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-element-link">Element</a><a href="https://medium.com/brushfam" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-medium-link">Medium</a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/OpenBrush">OpenBrush</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Sol2ink">Sol2ink</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/capabilities">Capabilities</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Sol2ink/tutorial/preparation">ERC-20 Tutorial</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/tutorial/preparation">Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Sol2ink/tutorial/building">Building the ink! smart contract</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing">How it works</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing">Parsing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing_interface">Parsing an interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing_library">Parsing a library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing_contract">Parsing a contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing_functions">Parsing functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/parsing_expressions">Parsing expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/how_it_works/assembler">Assembling a contract</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Sol2ink/issues">Known issues</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Typechain">Typechain</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/obce">OBCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cargo-contract">cargo-contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/substrate-contracts-node">substrate-contracts-node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/phat-contract">Phat Contract</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Sol2ink</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ERC-20 Tutorial</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Building the ink! smart contract</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Building the ink! smart contract</h1></header><p>To build the ink! smart contract we will need <a href="https://github.com/paritytech/cargo-contract" target="_blank" rel="noopener noreferrer">cargo-contract</a>. Note that the generated contracts use ink! version 3.4.0, so we will need to have <code>cargo-contract</code> version <code>1.5.1</code> installed. So if we satisfy this condition, we will navigate to the generated folder <code>generated/contracts/erc_20</code> and call cargo contract build. The contract will start building; we will wait for a while and...</p><p>It fails! So let&#x27;s look at the issue.</p><p>The first issue looks like this:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/43150707/216478364-737a042a-bfde-4061-b879-0e11f8e46b64.png" alt="issue0" class="img_ev3q"></p><p>The original code said <code>_balances[account] = accountBalance - amount;</code>, and Sol2Ink transpiled it as <code>self.data().balances.insert(&amp;(account), &amp;account_balance - amount);</code>, forgetting to put the argument of insert into parenthesis. We will ewritw it to <code>self.data().balances.insert(&amp;(account), &amp;(account_balance - amount));</code> (adding parenthesis), and the issue is gone.</p><p>Another issue will look like this:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/43150707/216478810-85683b50-a944-435c-89dc-fb6c72266209.png" alt="issue1" class="img_ev3q"></p><p>The Solidity expression <code>type(uint256).max</code> is parsed as <code>type_of(u128)?.max</code>. The correct form is <code>u128::MAX</code>, so we will rewrite it to that form. And try to build.</p><p>And we failed again.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/43150707/216479049-fdc2359b-1eb1-462d-ace6-3d0f4ded5074.png" alt="issue2" class="img_ev3q"></p><p>These issues have the same reason; we want to return a String which is the type that can not be copied. Fixing both of these issues is simple; we will return the clones of these strings by calling <code>.clone()</code> on them. </p><p>The last issues:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/43150707/216480272-4d8c9546-1ccc-4164-bd42-7c7868aa960d.png" alt="issue3" class="img_ev3q"></p><p>These occur because the original contract has some bases, which we did not provide, but Sol2Ink assumed we did, so it tried to implement them for the contract. We will just remove these line from the contract. Now when we build, everything works! Congratulations!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="warnings">Warnings<a href="#warnings" class="hash-link" aria-label="Direct link to Warnings" title="Direct link to Warnings">​</a></h3><p>You could have noticed some warnings. The cause of these warnings is that Sol2Ink implicitly sets all variables as mutable, even if we do not mutate them, so we will simply remove the <code>mut</code> keyword on the highlighted places. Also, there are some functions, which have parameters that are unused inside that function. It is not an issue, but if we want to remove these warnings, we will add <code>_</code> to the front of the names of these parameters (or rename them to <code>_</code>), implying that those parameters are unused. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-things-to-notice">More things to notice<a href="#more-things-to-notice" class="hash-link" aria-label="Direct link to More things to notice" title="Direct link to More things to notice">​</a></h3><p>Sol2Ink is able to parse most of the Solidity contracts, however, there may be some code which we did not have the chance to cover properly yet. It will be parsed, but there is a way in ink! on how to handle these cases specifically. We are working on it to make Sol2Ink even more usable and we will cover them in the <code>Known issues</code> section. And that&#x27;s it! Now it is the developer&#x27;s job to optimize the contract for Rust and ink!, but the dirty work is already behind us!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Sol2ink/tutorial/preparation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Preparation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Sol2ink/how_it_works/parsing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Parsing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#warnings" class="table-of-contents__link toc-highlight">Warnings</a></li><li><a href="#more-things-to-notice" class="table-of-contents__link toc-highlight">More things to notice</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 Brushfam</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5d853318.js"></script>
<script src="/assets/js/main.2754e16f.js"></script>
</body>
</html>